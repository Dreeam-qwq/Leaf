From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Taiyou06 <kaandindar21@gmail.com>
Date: Sat, 8 Feb 2025 22:11:16 +0100
Subject: [PATCH] Remove-streams-from-villagers


diff --git a/net/minecraft/world/entity/ai/behavior/TradeWithVillager.java b/net/minecraft/world/entity/ai/behavior/TradeWithVillager.java
index 4d8523a43d60cd6b4fd5546ffb3a61417b2c475b..a48826c0b2c3d1c69fb2b40888d74f8e86083298 100644
--- a/net/minecraft/world/entity/ai/behavior/TradeWithVillager.java
+++ b/net/minecraft/world/entity/ai/behavior/TradeWithVillager.java
@@ -77,9 +77,15 @@ public class TradeWithVillager extends Behavior<Villager> {
     }
 
     private static Set<Item> figureOutWhatIAmWillingToTrade(Villager villager, Villager other) {
-        ImmutableSet<Item> set = other.getVillagerData().getProfession().requestedItems();
-        ImmutableSet<Item> set1 = villager.getVillagerData().getProfession().requestedItems();
-        return set.stream().filter(item -> !set1.contains(item)).collect(Collectors.toSet());
+        ImmutableSet<Item> otherItems = other.getVillagerData().getProfession().requestedItems();
+        ImmutableSet<Item> villagerItems = villager.getVillagerData().getProfession().requestedItems();
+        Set<Item> result = new java.util.HashSet<>();
+        for (Item item : otherItems) {
+            if (!villagerItems.contains(item)) {
+                result.add(item);
+            }
+        }
+        return result;
     }
 
     private static void throwHalfStack(Villager villager, Set<Item> stack, LivingEntity entity) {
diff --git a/net/minecraft/world/entity/npc/Villager.java b/net/minecraft/world/entity/npc/Villager.java
index bee017f2c47a9f0876e2e05ce1c720332fb74566..9c53bf139ef18c2c70fc35e15c2f8761d2e1c12c 100644
--- a/net/minecraft/world/entity/npc/Villager.java
+++ b/net/minecraft/world/entity/npc/Villager.java
@@ -985,7 +985,15 @@ public class Villager extends AbstractVillager implements ReputationEventHandler
 
     private int countFoodPointsInInventory() {
         SimpleContainer inventory = this.getInventory();
-        return FOOD_POINTS.entrySet().stream().mapToInt(entry -> inventory.countItem(entry.getKey()) * entry.getValue()).sum();
+        int sum = 0;
+
+        for (Map.Entry<Item, Integer> entry : FOOD_POINTS.entrySet()) {
+            Item item = entry.getKey();
+            int points = entry.getValue();
+            sum += inventory.countItem(item) * points;
+        }
+
+        return sum;
     }
 
     public boolean hasFarmSeeds() {
