From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: William Blake Galbreath <Blake.Galbreath@GMail.com>
Date: Mon, 17 Aug 2020 17:34:33 -0500
Subject: [PATCH] Purpur: Crying obsidian valid for portal frames

Original license: MIT
Original project: https://github.com/PurpurMC/Purpur

diff --git a/src/main/java/net/minecraft/world/level/portal/PortalShape.java b/src/main/java/net/minecraft/world/level/portal/PortalShape.java
index c461e0d04047db9c0c5ecc04063cebd38bf96ec2..3789f1b58b55829948a76b690ebdb1c1030c0f22 100644
--- a/src/main/java/net/minecraft/world/level/portal/PortalShape.java
+++ b/src/main/java/net/minecraft/world/level/portal/PortalShape.java
@@ -25,6 +25,7 @@ import net.minecraft.world.phys.shapes.VoxelShape;
 // CraftBukkit start
 import org.bukkit.craftbukkit.event.CraftPortalEvent;
 import org.bukkit.event.world.PortalCreateEvent;
+import org.dreeam.leaf.LeafConfig;
 // CraftBukkit end
 
 public class PortalShape {
@@ -34,7 +35,7 @@ public class PortalShape {
     private static final int MIN_HEIGHT = 3;
     public static final int MAX_HEIGHT = 21;
     private static final BlockBehaviour.StatePredicate FRAME = (iblockdata, iblockaccess, blockposition) -> {
-        return iblockdata.is(Blocks.OBSIDIAN);
+        return iblockdata.is(Blocks.OBSIDIAN) || (LeafConfig.cryingObsidianValidForPortalFrame && iblockdata.is(Blocks.CRYING_OBSIDIAN)); // Purpur
     };
     private static final float SAFE_TRAVEL_MAX_ENTITY_XY = 4.0F;
     private static final double SAFE_TRAVEL_MAX_VERTICAL_DELTA = 1.0D;
diff --git a/src/main/java/org/dreeam/leaf/LeafConfig.java b/src/main/java/org/dreeam/leaf/LeafConfig.java
index 50585a3de7ac5b7b2356c2f6d09784d16264a39f..966dbe555e282dc167000fff8b68f1cf1ec4c563 100644
--- a/src/main/java/org/dreeam/leaf/LeafConfig.java
+++ b/src/main/java/org/dreeam/leaf/LeafConfig.java
@@ -350,6 +350,7 @@ public class LeafConfig {
     public static boolean disableMushroomBlockUpdates = false;
     public static boolean disableNoteBlockUpdates = false;
     public static boolean disableChorusPlantUpdates = false;
+    public static boolean cryingObsidianValidForPortalFrame = false;
     private static void blockSettings() {
         spongeAbsorptionArea = getInt("blocks.sponge.absorption.area", spongeAbsorptionArea);
         spongeAbsorptionRadius = getInt("blocks.sponge.absorption.radius", spongeAbsorptionRadius);
@@ -395,6 +396,7 @@ public class LeafConfig {
         disableMushroomBlockUpdates = getBoolean("blocks.disable-mushroom-updates", disableMushroomBlockUpdates);
         disableNoteBlockUpdates = getBoolean("blocks.disable-note-block-updates", disableNoteBlockUpdates);
         disableChorusPlantUpdates = getBoolean("blocks.disable-chorus-plant-updates", disableChorusPlantUpdates);
+        cryingObsidianValidForPortalFrame = getBoolean("settings.blocks.crying_obsidian.valid-for-portal-frame", cryingObsidianValidForPortalFrame);
     }
 
     public static boolean kickForOutOfOrderChat = true;
